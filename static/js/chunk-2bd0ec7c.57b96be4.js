(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bd0ec7c"],{"2b12":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"top"},[a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("新增")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.edit}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.deleteUser}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.updateStatus}},[t._v("启用")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.updateStatus}},[t._v("停用")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isSet=!0}}},[t._v("重置密码")])],1),t._v(" "),a("div",{staticClass:"user_search"},[a("span",{staticStyle:{"line-height":"36px"}},[t._v("账户名称 :")]),t._v(" "),a("el-input",{staticClass:"ipt-search",attrs:{placeholder:"请输入用户名称"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),t._v(" "),a("span",{staticStyle:{"line-height":"36px"}},[t._v("账户编号 :")]),t._v(" "),a("el-input",{staticClass:"ipt-search",attrs:{placeholder:"请输入用户编号"},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}}),t._v(" "),a("el-button",{on:{click:t.searchInfo}},[t._v("搜索")]),t._v(" "),a("el-button",{on:{click:t.reset}},[t._v("重置")])],1),t._v(" "),a("div",{staticClass:"line"})]),t._v(" "),a("div",{staticClass:"main-body"},[a("div",{staticClass:"lf_list"},[a("el-table",{ref:"multipleTable",attrs:{data:t.userList,border:"","highlight-current-row":""},on:{"current-change":t.handleCurrentChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"账户名称",prop:"nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"账户编号",prop:"uid"}}),t._v(" "),a("el-table-column",{attrs:{label:"有效状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s("1"==e.row.is_valid?"是":"否"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"说明",prop:"remarks"}})],1)],1),t._v(" "),a("div",{staticClass:"rt_info"},[a("el-tag",{staticStyle:{"margin-left":"15px"}},[t._v("基本信息")]),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"item"},[a("span",{staticClass:"tit"},[t._v("账户ID:")]),t._v("\n          "+t._s(t.currentRow.uid)+"\n        ")]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"tit"},[t._v("账户名称:")]),t._v(" "),a("span",[t._v(t._s(t.currentRow.nickname))])]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"tit"},[t._v("账户角色:")]),t._v(" "),a("span",[t._v(t._s(t.currentRow.account))])]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"tit"},[t._v("所属组织:")]),t._v(" "),a("span",[t._v(t._s(t.currentRow.customer_id))])]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"tit"},[t._v("注册手机号:")]),t._v(" "),a("span",[t._v(t._s(t.currentRow.reg_mobile))])]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"tit"},[t._v("是否有效:")]),t._v("\n          "+t._s("1"==t.currentRow.is_valid?"是":"否")+"\n        ")]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"tit"},[t._v("有效日期:")]),t._v(" "),a("span",[t._v(t._s(t.currentRow.valid_time))])]),t._v(" "),a("div",{staticClass:"item",staticStyle:{width:"80%"}},[a("span",{staticClass:"tit",staticStyle:{width:"20%"}},[t._v("说明:")]),t._v(" "),a("span",[t._v(t._s(t.currentRow.remarks))])])])],1)]),t._v(" "),a("el-dialog",{attrs:{title:t.title,visible:t.isShowAdd,width:"50%"},on:{"update:visible":function(e){t.isShowAdd=e}}},[a("div",[a("el-form",{ref:"ruleForm",staticClass:"add_info",attrs:{rules:t.rules,"label-width":"80px","label-position":"left",model:t.addInfo}},[a("el-form-item",{staticClass:"item",attrs:{label:"账户名称",prop:"nickname"}},[a("el-input",{model:{value:t.addInfo.nickname,callback:function(e){t.$set(t.addInfo,"nickname",e)},expression:"addInfo.nickname"}})],1),t._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"账户角色",prop:"account"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addInfo.account,callback:function(e){t.$set(t.addInfo,"account",e)},expression:"addInfo.account"}},t._l(t.accountList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),"编辑账户"!==t.title?a("el-form-item",{staticClass:"item",attrs:{label:"登录密码",prop:"password"}},[a("el-input",{model:{value:t.addInfo.password,callback:function(e){t.$set(t.addInfo,"password",e)},expression:"addInfo.password"}})],1):t._e(),t._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"所属客户",prop:"customer_id"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addInfo.customer_id,callback:function(e){t.$set(t.addInfo,"customer_id",e)},expression:"addInfo.customer_id"}},t._l(t.clientLists,function(t){return a("el-option",{key:t.cid,attrs:{label:t.nickname,value:t.cid}})}),1)],1),t._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"注册手机号",prop:"reg_mobile"}},[a("el-input",{model:{value:t.addInfo.reg_mobile,callback:function(e){t.$set(t.addInfo,"reg_mobile",e)},expression:"addInfo.reg_mobile"}})],1),t._v(" "),"编辑账户"!==t.title?a("el-form-item",{staticClass:"item",attrs:{label:"是否启用"}},[a("el-select",{model:{value:t.addInfo.is_valid,callback:function(e){t.$set(t.addInfo,"is_valid",e)},expression:"addInfo.is_valid"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1):t._e(),t._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"有效日期",prop:"valid_time"}},[a("el-date-picker",{attrs:{"value-format":"timestamp",type:"date",placeholder:"选择日期"},model:{value:t.addInfo.valid_time,callback:function(e){t.$set(t.addInfo,"valid_time",e)},expression:"addInfo.valid_time"}})],1),t._v(" "),a("el-form-item",{staticClass:"item",attrs:{label:"说明"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.addInfo.remarks,callback:function(e){t.$set(t.addInfo,"remarks",e)},expression:"addInfo.remarks"}})],1),t._v(" "),a("el-form-item",{staticClass:"tx",attrs:{label:"头像上传"}},[a("input",{ref:"inputer",attrs:{type:"file",multiple:"",accept:"image/png, image/jpeg, image/jpg"},on:{change:t.getuserphoto}}),t._v(" "),t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.isShowAdd=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addUser("ruleForm")}}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"重置密码",visible:t.isSet,width:"30%"},on:{"update:visible":function(e){t.isSet=e}}},[a("div",[a("el-form",{attrs:{"label-width":"80px"},model:{value:t.pword,callback:function(e){t.pword=e},expression:"pword"}},[a("el-form-item",{staticClass:"ipt_pword",attrs:{label:"用户"}},[a("span",[t._v(t._s(t.currentRow.nickname))])]),t._v(" "),a("el-form-item",{staticClass:"ipt_pword",attrs:{label:"原密码"}},[a("el-input",{attrs:{type:t.oldpasswordType},model:{value:t.pword.forme_password,callback:function(e){t.$set(t.pword,"forme_password",e)},expression:"pword.forme_password"}}),t._v(" "),a("span",{staticClass:"show-pwd",on:{click:function(e){return t.showPwd("old")}}},[a("svg-icon",{attrs:{"icon-class":"password"===t.oldpasswordType?"eye":"eye-open"}})],1)],1),t._v(" "),a("el-form-item",{staticClass:"ipt_pword",attrs:{label:"新密码"}},[a("el-input",{attrs:{type:t.newpasswordType},model:{value:t.pword.reset_password,callback:function(e){t.$set(t.pword,"reset_password",e)},expression:"pword.reset_password"}}),t._v(" "),a("span",{staticClass:"show-pwd",on:{click:function(e){return t.showPwd("new")}}},[a("svg-icon",{attrs:{"icon-class":"password"===t.newpasswordType?"eye":"eye-open"}})],1)],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.isSet=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.resetPassword()}}},[t._v("确 定")])],1)])],1)},i=[],n=a("4360"),r=a("bc3a"),o=a.n(r),l=a("5723"),d=a("cc5e"),c=a("b39f"),u={data:function(){return{title:"",editForm:"",username:"",userId:"",userList:[],textarea:"",currentRow:"",isShowAdd:!1,addInfo:{customer_id:"",nickname:"",account:"",password:"",reg_mobile:"",is_valid:"1",valid_time:"",remarks:"",face_img:""},temp:{customer_id:"",nickname:"",account:"",password:"",reg_mobile:"",is_valid:"1",valid_time:"",remarks:"",face_img:""},imageUrl:"",formdate:"",rules:{customer_id:[{required:!0,message:"请输入用户ID",trigger:"blur"}],nickname:[{required:!0,message:"请输入用户名称",trigger:"blur"}],account:[{required:!0,message:"请输入账户角色",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],reg_mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],valid_time:[{type:"date",required:!0,message:"请选择有效日期",trigger:"change"}]},isSet:!1,pword:{forme_password:"",reset_password:"changyi#2019"},oldpasswordType:"password",newpasswordType:"password",token:n["a"].getters.token,accountList:[],clientLists:[]}},created:function(){this.getAdminInfo(),this.getaddlist()},methods:{getaddlist:function(){var t=this;Object(d["e"])().then(function(e){console.log(e),t.accountList=e.data}),Object(c["c"])().then(function(e){t.clientLists=e.data})},getuserphoto:function(){console.log("上传头像");var t=this,e=t.$refs.inputer,a=e.files[0],s=a.size;if(void 0===s)return!1;console.log(s);var i=new FileReader;i.onloadend=function(){var e=this;t.imageUrl=i.result;var s=o.a.create({baseURL:"http://cdpapi.vchangyi.com",withCredentials:!0,timeout:5e3});s.interceptors.request.use(function(t){return t.headers["Token"]=n["a"].getters.token,t});var r=new FormData;function l(t){return s({url:"app/file/upload",method:"post",data:t})}r.append("picture",a),l(r).then(function(t){console.log(t),e.addInfo.face_img=t.data})},i.readAsDataURL(a)},edit:function(){this.editForm=this.currentRow,this.addInfo=this.temp,this.title="编辑账户",this.addInfo.uid=this.currentRow.uid,this.addInfo.nickname=this.currentRow.nickname,this.addInfo.account=this.currentRow.account,this.addInfo.reg_mobile=this.currentRow.reg_mobile,this.addInfo.valid_time=this.currentRow.valid_time+"000",this.addInfo.remarks=this.currentRow.remarks,this.addInfo.customer_id=this.currentRow.customer_id,console.log(this.addInfo),this.isShowAdd=!0},getAdminInfo:function(){var t=this,e={page:1,size:10,user_name:this.username,user_no:this.userId};Object(l["b"])(e).then(function(e){console.log(e),t.userList=e.data,t.currentRow=e.data[0]})},handleCurrentChange:function(t){this.currentRow=t;var e=this.userList.indexOf(t);this.$refs.multipleTable.clearSelection(),this.$refs.multipleTable.toggleRowSelection(this.userList[e]),console.log(t)},searchInfo:function(){this.getAdminInfo()},reset:function(){this.username="",this.userId="",this.getAdminInfo()},handleAvatarSuccess:function(t,e){console.log(e),this.imageUrl=URL.createObjectURL(e.raw)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},add:function(){this.isShowAdd=!0,this.title="新增账户",this.addInfo={},this.addInfo.valid_time=407088e7},addUser:function(t){var e=this;this.$refs[t].validate(function(a){if(!a)return!1;e.addInfo.valid_time=parseInt(e.addInfo.valid_time/1e3);var s=e;Object(l["a"])(e.addInfo).then(function(a){console.log(a),s.$refs[t].resetFields(),e.isShowAdd=!1,e.getAdminInfo()})})},updateStatus:function(t){var e,a=this;console.log(t.target.innerText,1),e="启用"===t.target.innerText?"1":"0",Object(l["f"])({uid:this.currentRow.uid,is_valid:e}).then(function(t){console.log(t),a.getAdminInfo()})},showPwd:function(t){"old"===t?(console.log("old"),this.oldpasswordType="password"===this.oldpasswordType?"text":"password"):(console.log("new"),this.newpasswordType="password"===this.newpasswordType?"text":"password")},resetPassword:function(){var t=this.pword;t.uid=this.currentRow.uid,Object(l["e"])(t).then(function(t){console.log(t)})},deleteUser:function(){var t=this;this.$confirm("此操作将删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l["d"])({uid:t.currentRow.uid}).then(function(e){t.getAdminInfo(),t.$message({type:"success",message:"删除成功!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},p=u,m=(a("d445"),a("2877")),f=Object(m["a"])(p,s,i,!1,null,"2583f3d6",null);e["default"]=f.exports},5723:function(t,e,a){"use strict";a.d(e,"b",function(){return i}),a.d(e,"c",function(){return n}),a.d(e,"a",function(){return r}),a.d(e,"f",function(){return o}),a.d(e,"e",function(){return l}),a.d(e,"d",function(){return d});var s=a("b775");function i(t){return Object(s["a"])({url:"app/setting/admin/list",method:"post",data:t})}function n(t){return Object(s["a"])({url:"app/setting/admin/listAdmin",method:"post",data:t})}function r(t){return Object(s["a"])({url:"app/setting/admin/add",method:"post",data:t})}function o(t){return Object(s["a"])({url:"app/setting/admin/updateValid",method:"post",data:t})}function l(t){return Object(s["a"])({url:"app/setting/admin/reset-password",method:"post",data:t})}function d(t){return Object(s["a"])({url:"app/setting/admin/delete",method:"post",data:t})}},b39f:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"b",function(){return n}),a.d(e,"a",function(){return r}),a.d(e,"d",function(){return o});var s=a("b775");function i(t){return Object(s["a"])({url:"app/setting/customer/list",method:"post",data:t})}function n(){return Object(s["a"])({url:"app/setting/enumerate/listapp",method:"post"})}function r(t){return Object(s["a"])({url:"app/setting/customer/add",method:"post",data:t})}function o(t){return Object(s["a"])({url:"app/setting/customer/delete",method:"post",data:t})}},cc5e:function(t,e,a){"use strict";a.d(e,"e",function(){return i}),a.d(e,"b",function(){return n}),a.d(e,"c",function(){return r}),a.d(e,"f",function(){return o}),a.d(e,"d",function(){return l}),a.d(e,"a",function(){return d});var s=a("b775");function i(t){return Object(s["a"])({url:"app/setting/role/list",method:"post",data:t})}function n(t){return Object(s["a"])({url:"app/setting/role/add",method:"post",data:t})}function r(t){return Object(s["a"])({url:"app/setting/role/delete",method:"post",data:t})}function o(t){return Object(s["a"])({url:"app/setting/role/update",method:"post",data:t})}function l(t){return Object(s["a"])({url:"app/setting/role/addRoleAdmin",method:"post",data:t})}function d(t){return Object(s["a"])({url:"app/setting/role/addRoleMenu",method:"post",data:t})}},d445:function(t,e,a){"use strict";var s=a("e3a4"),i=a.n(s);i.a},e3a4:function(t,e,a){}}]);